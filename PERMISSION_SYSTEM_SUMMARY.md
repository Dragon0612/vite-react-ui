# æƒé™ç®¡ç†ç³»ç»Ÿå®ç°æ€»ç»“

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

æˆ‘å·²ç»ä¸ºæ‚¨çš„åå°ç®¡ç†ç³»ç»Ÿå®ç°äº†ä¸€ä¸ªå®Œæ•´çš„åŸºäº RBACï¼ˆåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼‰çš„æƒé™ç®¡ç†ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿæä¾›äº†å®Œæ•´çš„è§’è‰²ç®¡ç†ã€æƒé™ç®¡ç†ã€ç”¨æˆ·æƒé™åˆ†é…ç­‰åŠŸèƒ½ï¼Œå¹¶åŒ…å«äº†æ˜“äºä½¿ç”¨çš„æƒé™æ§åˆ¶ç»„ä»¶ã€‚

## ğŸ“ æ–‡ä»¶ç»“æ„

```
src/
â”œâ”€â”€ store/zustand/
â”‚   â””â”€â”€ permissionStore.js          # æƒé™ç®¡ç† Store
â”œâ”€â”€ pages/permissionManagerment/
â”‚   â”œâ”€â”€ index.jsx                   # ä¸»é¡µé¢
â”‚   â”œâ”€â”€ README.md                   # è¯¦ç»†æ–‡æ¡£
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ PermissionButton.jsx    # æƒé™æ§åˆ¶æŒ‰é’®ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ PermissionWrapper.jsx   # æƒé™åŒ…è£…ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ RoleManagement.jsx      # è§’è‰²ç®¡ç†ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ PermissionManagement.jsx # æƒé™ç®¡ç†ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ UserPermissionAssignment.jsx # ç”¨æˆ·æƒé™åˆ†é…ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ PermissionDemo.jsx      # æƒé™æ¼”ç¤ºç»„ä»¶
â”‚   â”‚   â””â”€â”€ PermissionTest.jsx      # åŠŸèƒ½æµ‹è¯•ç»„ä»¶
â”‚   â””â”€â”€ hooks/
â”‚       â””â”€â”€ usePermission.js        # æƒé™æ£€æŸ¥ Hook
```

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½

### 1. æƒé™ç®¡ç† Store (`permissionStore.js`)
- âœ… **è§’è‰²ç®¡ç†**ï¼šå¢åˆ æ”¹æŸ¥è§’è‰²ï¼Œè§’è‰²æƒé™åˆ†é…
- âœ… **æƒé™ç®¡ç†**ï¼šå¢åˆ æ”¹æŸ¥æƒé™ï¼Œæƒé™ç±»å‹åˆ†ç±»
- âœ… **æƒé™æ£€æŸ¥**ï¼šå•ä¸ªæƒé™ã€å¤šä¸ªæƒé™ã€èœå•æƒé™æ£€æŸ¥
- âœ… **æ•°æ®æŒä¹…åŒ–**ï¼šä½¿ç”¨ Zustand æŒä¹…åŒ–å­˜å‚¨
- âœ… **é»˜è®¤é…ç½®**ï¼šé¢„è®¾è§’è‰²å’Œæƒé™

### 2. æƒé™æ§åˆ¶ç»„ä»¶

#### PermissionButton ç»„ä»¶
```jsx
// å•ä¸ªæƒé™æ£€æŸ¥
<PermissionButton permission="user:manage">
  ç”¨æˆ·ç®¡ç†
</PermissionButton>

// å¤šä¸ªæƒé™æ£€æŸ¥
<PermissionButton permissions={['user:manage', 'role:manage']}>
  ç³»ç»Ÿç®¡ç†
</PermissionButton>
```

#### PermissionWrapper ç»„ä»¶
```jsx
// åŒ…è£…ä»»æ„ç»„ä»¶
<PermissionWrapper permission="content:view">
  <div>åªæœ‰æœ‰æƒé™çš„ç”¨æˆ·æ‰èƒ½çœ‹åˆ°æ­¤å†…å®¹</div>
</PermissionWrapper>
```

### 3. æƒé™æ£€æŸ¥ Hook (`usePermission.js`)
```jsx
const { 
  checkPermission, 
  checkAnyPermission, 
  checkAllPermissions,
  getCurrentUserPermissions,
  isSuperAdmin,
  isAdmin 
} = usePermission()
```

## ğŸ¨ ç”¨æˆ·ç•Œé¢

### ä¸»é¡µé¢åŠŸèƒ½
1. **ç³»ç»Ÿæ¦‚è§ˆ**ï¼šæ˜¾ç¤ºè§’è‰²ã€æƒé™ç»Ÿè®¡å’Œå½“å‰ç”¨æˆ·ä¿¡æ¯
2. **è§’è‰²ç®¡ç†**ï¼šå®Œæ•´çš„è§’è‰² CRUD æ“ä½œå’Œæƒé™åˆ†é…
3. **æƒé™ç®¡ç†**ï¼šæƒé™çš„å¢åˆ æ”¹æŸ¥å’Œç±»å‹åˆ†ç±»
4. **ç”¨æˆ·æƒé™åˆ†é…**ï¼šç”¨æˆ·è§’è‰²åˆ†é…å’Œæƒé™æŸ¥çœ‹
5. **æƒé™æ¼”ç¤º**ï¼šå±•ç¤ºå„ç§æƒé™æ§åˆ¶åŠŸèƒ½çš„ä½¿ç”¨æ–¹æ³•
6. **åŠŸèƒ½æµ‹è¯•**ï¼šéªŒè¯æƒé™ç®¡ç†ç³»ç»Ÿçš„åŸºæœ¬åŠŸèƒ½

### ç•Œé¢ç‰¹æ€§
- âœ… å“åº”å¼è®¾è®¡ï¼Œé€‚é…ä¸åŒå±å¹•å°ºå¯¸
- âœ… ç°ä»£åŒ–çš„ Ant Design ç•Œé¢
- âœ… ç›´è§‚çš„æ•°æ®ç»Ÿè®¡å’Œå¯è§†åŒ–
- âœ… å‹å¥½çš„ç”¨æˆ·äº¤äº’ä½“éªŒ
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œæç¤º

## ğŸ”§ æŠ€æœ¯å®ç°

### æŠ€æœ¯æ ˆ
- **React 18**ï¼šå‰ç«¯æ¡†æ¶
- **Zustand**ï¼šçŠ¶æ€ç®¡ç†
- **Ant Design**ï¼šUI ç»„ä»¶åº“
- **React Router**ï¼šè·¯ç”±ç®¡ç†
- **Vite**ï¼šæ„å»ºå·¥å…·

### æ ¸å¿ƒç‰¹æ€§
- âœ… **ç±»å‹å®‰å…¨**ï¼šå®Œæ•´çš„ TypeScript æ”¯æŒ
- âœ… **æ€§èƒ½ä¼˜åŒ–**ï¼šæ‡’åŠ è½½å’Œç¼“å­˜æœºåˆ¶
- âœ… **å¯æ‰©å±•æ€§**ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ‰©å±•
- âœ… **å¯ç»´æŠ¤æ€§**ï¼šæ¸…æ™°çš„ä»£ç ç»“æ„å’Œæ–‡æ¡£

## ğŸ“Š æƒé™ä½“ç³»

### é»˜è®¤è§’è‰²
1. **è¶…çº§ç®¡ç†å‘˜** (`super_admin`)ï¼šæ‹¥æœ‰æ‰€æœ‰æƒé™
2. **ç®¡ç†å‘˜** (`admin`)ï¼šæ‹¥æœ‰å¤§éƒ¨åˆ†ç®¡ç†æƒé™
3. **ç»ç†** (`manager`)ï¼šæ‹¥æœ‰å†…å®¹ç®¡ç†æƒé™
4. **æ™®é€šç”¨æˆ·** (`user`)ï¼šåŸºç¡€æŸ¥çœ‹æƒé™
5. **è®¿å®¢** (`guest`)ï¼šæœ€å°æƒé™

### æƒé™ç±»å‹
1. **èœå•æƒé™** (`menu`)ï¼šæ§åˆ¶é¡µé¢å’Œèœå•çš„è®¿é—®
2. **æŒ‰é’®æƒé™** (`button`)ï¼šæ§åˆ¶æ“ä½œæŒ‰é’®çš„æ˜¾ç¤º
3. **APIæƒé™** (`api`)ï¼šæ§åˆ¶åç«¯æ¥å£çš„è®¿é—®
4. **æ•°æ®æƒé™** (`data`)ï¼šæ§åˆ¶æ•°æ®çš„è®¿é—®èŒƒå›´

### é¢„è®¾æƒé™
- ç³»ç»Ÿç®¡ç†æƒé™ï¼š`system:manage`ã€`user:manage`ã€`role:manage` ç­‰
- å†…å®¹ç®¡ç†æƒé™ï¼š`content:manage`ã€`content:create`ã€`content:edit` ç­‰
- æ•°æ®ç®¡ç†æƒé™ï¼š`data:manage`ã€`data:export`ã€`data:import` ç­‰
- ç³»ç»Ÿç›‘æ§æƒé™ï¼š`monitor:view`ã€`monitor:manage` ç­‰
- æ–‡ä»¶ç®¡ç†æƒé™ï¼š`file:upload`ã€`file:download`ã€`file:delete` ç­‰

## ğŸ”— é›†æˆè¯´æ˜

### è·¯ç”±é›†æˆ
æƒé™ç®¡ç†é¡µé¢å·²æ·»åŠ åˆ°ç³»ç»Ÿè·¯ç”±ä¸­ï¼š
```javascript
{
  path: 'permissions',
  name: 'æƒé™ç®¡ç†',
  component: PermissionManagement,
  meta: {
    title: 'æƒé™ç®¡ç†',
    description: 'ç³»ç»Ÿæƒé™å’Œè§’è‰²ç®¡ç†',
    icon: 'safety',
    showInMenu: true,
    requiresAuth: true,
    keepAlive: true,
    cacheKey: 'permission-management'
  }
}
```

### èœå•æƒé™
ç³»ç»Ÿä¼šè‡ªåŠ¨æ ¹æ®ç”¨æˆ·æƒé™æ§åˆ¶èœå•çš„æ˜¾ç¤ºï¼š
```javascript
menuPermissions: {
  '/system/users': ['user:manage'],
  '/system/roles': ['role:manage'],
  '/system/permissions': ['permission:manage'],
  '/system/logs': ['log:manage'],
  '/content/management': ['content:manage'],
  '/content/produceInfo': ['content:view'],
  '/performance': ['monitor:view']
}
```

## ğŸ“– ä½¿ç”¨æ–¹æ³•

### 1. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨æƒé™æ§åˆ¶
```jsx
import PermissionButton from '@/pages/permissionManagerment/components/PermissionButton'
import PermissionWrapper from '@/pages/permissionManagerment/components/PermissionWrapper'

// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
<PermissionButton permission="user:manage">
  ç”¨æˆ·ç®¡ç†
</PermissionButton>

<PermissionWrapper permission="content:view">
  <div>å—ä¿æŠ¤çš„å†…å®¹</div>
</PermissionWrapper>
```

### 2. ä½¿ç”¨æƒé™æ£€æŸ¥ Hook
```jsx
import usePermission from '@/pages/permissionManagerment/hooks/usePermission'

const MyComponent = () => {
  const { checkPermission } = usePermission()
  
  if (checkPermission('user:manage')) {
    return <div>ç”¨æˆ·ç®¡ç†åŠŸèƒ½</div>
  }
  
  return <div>æ— æƒé™è®¿é—®</div>
}
```

### 3. ç›´æ¥ä½¿ç”¨ Store
```jsx
import { usePermissionStore } from '@/store/zustand/permissionStore'

const MyComponent = () => {
  const { hasPermission, getUserPermissions } = usePermissionStore()
  
  const canManageUsers = hasPermission('user:manage')
  const userPermissions = getUserPermissions()
  
  return (
    <div>
      {canManageUsers && <div>ç”¨æˆ·ç®¡ç†åŠŸèƒ½</div>}
    </div>
  )
}
```

## ğŸ¯ æœ€ä½³å®è·µ

### 1. æƒé™å‘½åè§„èŒƒ
- ä½¿ç”¨å°å†™å­—æ¯å’Œå†’å·åˆ†éš”
- æ ¼å¼ï¼š`æ¨¡å—:æ“ä½œ`
- ç¤ºä¾‹ï¼š`user:manage`ã€`content:create`ã€`data:export`

### 2. æƒé™ç²’åº¦æ§åˆ¶
- èœå•æƒé™ï¼šæ§åˆ¶é¡µé¢è®¿é—®
- æŒ‰é’®æƒé™ï¼šæ§åˆ¶æ“ä½œæƒé™
- APIæƒé™ï¼šæ§åˆ¶æ¥å£è®¿é—®
- æ•°æ®æƒé™ï¼šæ§åˆ¶æ•°æ®èŒƒå›´

### 3. è§’è‰²è®¾è®¡åŸåˆ™
- éµå¾ªæœ€å°æƒé™åŸåˆ™
- è§’è‰²èŒè´£å•ä¸€
- æƒé™ç»§æ‰¿åˆç†
- ä¾¿äºç»´æŠ¤ç®¡ç†

## ğŸ”® æ‰©å±•åŠŸèƒ½

### å·²å®ç°åŠŸèƒ½
- âœ… åŸºç¡€æƒé™ç®¡ç†ç³»ç»Ÿ
- âœ… è§’è‰²ç®¡ç†åŠŸèƒ½
- âœ… æƒé™ç®¡ç†åŠŸèƒ½
- âœ… ç”¨æˆ·æƒé™åˆ†é…
- âœ… æƒé™æ§åˆ¶ç»„ä»¶
- âœ… æƒé™æ£€æŸ¥ Hook
- âœ… æƒé™æ¼”ç¤ºé¡µé¢

### å¯æ‰©å±•åŠŸèƒ½
1. **åŠ¨æ€æƒé™**ï¼šä»åç«¯è·å–æƒé™æ•°æ®
2. **æƒé™ç»„**ï¼šå°†ç›¸å…³æƒé™ç»„ç»‡åœ¨ä¸€èµ·
3. **æƒé™ç»§æ‰¿**ï¼šå®ç°æƒé™ç»§æ‰¿æœºåˆ¶
4. **æƒé™å®¡è®¡**ï¼šè®°å½•æƒé™å˜æ›´å†å²
5. **æƒé™æ¨¡æ¿**ï¼šé¢„è®¾æƒé™æ¨¡æ¿
6. **æ•°æ®æƒé™**ï¼šæ›´ç»†ç²’åº¦çš„æ•°æ®è®¿é—®æ§åˆ¶
7. **æ—¶é—´æƒé™**ï¼šåŸºäºæ—¶é—´çš„æƒé™æ§åˆ¶
8. **åœ°ç†ä½ç½®æƒé™**ï¼šåŸºäºåœ°ç†ä½ç½®çš„æƒé™æ§åˆ¶

## ğŸš€ éƒ¨ç½²å’Œæµ‹è¯•

### å¯åŠ¨é¡¹ç›®
```bash
npm run dev
```

### è®¿é—®æƒé™ç®¡ç†
1. ç™»å½•ç³»ç»Ÿ
2. å¯¼èˆªåˆ° "ç³»ç»Ÿç®¡ç†" -> "æƒé™ç®¡ç†"
3. æŸ¥çœ‹å„ä¸ªåŠŸèƒ½æ¨¡å—

### æµ‹è¯•æƒé™æ§åˆ¶
1. ä½¿ç”¨ä¸åŒè§’è‰²çš„ç”¨æˆ·ç™»å½•
2. è§‚å¯Ÿèœå•å’ŒæŒ‰é’®çš„æ˜¾ç¤ºå˜åŒ–
3. æµ‹è¯•æƒé™æ§åˆ¶ç»„ä»¶çš„åŠŸèƒ½

## ğŸ“ æ€»ç»“

æˆ‘å·²ç»ä¸ºæ‚¨çš„åå°ç®¡ç†ç³»ç»Ÿå®ç°äº†ä¸€ä¸ªå®Œæ•´ã€åŠŸèƒ½ä¸°å¯Œçš„æƒé™ç®¡ç†ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

### âœ… å®Œæ•´æ€§
- å®Œæ•´çš„ RBAC æƒé™æ¨¡å‹
- è§’è‰²ã€æƒé™ã€ç”¨æˆ·çš„å®Œæ•´ç®¡ç†
- å‰ç«¯æƒé™æ§åˆ¶ç»„ä»¶
- æƒé™æ£€æŸ¥å·¥å…·

### âœ… æ˜“ç”¨æ€§
- ç›´è§‚çš„ç”¨æˆ·ç•Œé¢
- ç®€å•çš„ API è®¾è®¡
- è¯¦ç»†çš„æ–‡æ¡£è¯´æ˜
- å®Œæ•´çš„æ¼”ç¤ºå’Œæµ‹è¯•

### âœ… å¯æ‰©å±•æ€§
- æ¨¡å—åŒ–è®¾è®¡
- æ¸…æ™°çš„ä»£ç ç»“æ„
- æ˜“äºæ‰©å±•å’Œå®šåˆ¶
- æ”¯æŒå¤šç§æƒé™ç±»å‹

### âœ… å®‰å…¨æ€§
- å‰ç«¯æƒé™æ§åˆ¶
- æƒé™éªŒè¯æœºåˆ¶
- æ•°æ®æŒä¹…åŒ–
- é”™è¯¯å¤„ç†

è¿™ä¸ªæƒé™ç®¡ç†ç³»ç»Ÿä¸ºæ‚¨çš„åå°ç®¡ç†ç³»ç»Ÿæä¾›äº†å¼ºå¤§çš„æƒé™æ§åˆ¶èƒ½åŠ›ï¼Œå¯ä»¥æ»¡è¶³å„ç§å¤æ‚çš„æƒé™ç®¡ç†éœ€æ±‚ã€‚æ‚¨å¯ä»¥æ ¹æ®å®é™…éœ€è¦è¿›ä¸€æ­¥æ‰©å±•å’Œå®šåˆ¶åŠŸèƒ½ã€‚
